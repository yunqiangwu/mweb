<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>å‰ç«¯æŒç»­é›†æˆç¯å¢ƒæ­å»º | Wayne</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  
  
    <link rel="alternate" href="/atom.xml" title="Wayne" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
  
    
<link rel="stylesheet" href="/localshare/css/share.css">

  
  
  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Wayne</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">æœ‰ç†æƒ³çš„ç å†œ</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/."><i class="fa fa-home"></i> é¦–é¡µ</a>
        
          <a class="main-nav-link" href="/archives/"><i class="fa fa-archive"></i> å½’æ¡£</a>
        
          <a class="main-nav-link" href="/about/"><i class="fa fa-user"></i> å…³äº</a>
        
          <a class="main-nav-link" href="/atom.xml"><i class="fa fa-rss"></i> è®¢é˜…</a>
        
      </nav>
    </div>
    <div id="search-form">
      <div id="result-mask" class="hide"></div>
      <label><input id="search-key" type="text" autocomplete="off" placeholder="æœç´¢"></label>
      <div id="result-wrap" class="hide">
        <div id="search-result"></div>
      </div>
      <div class="hide">
        <template id="search-tpl">
          <div class="item">
            <a href="/{path}" title="{title}">
              <div class="title">{title}</div>
              <div class="time">{date}</div>
              <div class="tags">{tags}</div>
            </a>
          </div>
        </template>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-2020-02-19" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      å‰ç«¯æŒç»­é›†æˆç¯å¢ƒæ­å»º
    </h1>
  


      </header>
    
    <div class="article-meta">
      
      <span class="article-date">
  <i class="fa fa-date"></i>
  <time class="dt-published" datetime="2020-02-19T00:00:00.000Z" itemprop="datePublished">2020å¹´02æœˆ19æ—¥</time>
</span>
      
      
        <span class="article-views">
  <i class="fa fa-views"></i>
  <i id="busuanzi_container_page_pv">
      <i id="busuanzi_value_page_pv"></i>
  </i>
</span>

      
      
<a href="/2020/02/19/2020-02-19/#comments" class="article-comment-link">
  
    
    
    
    
    
  
  <i class="fa fa-commt"></i>
  ç•™è¨€
</a>


    </div>
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="jenkins-nginx-å®ç°æŒç»­é›†æˆ"><a href="#jenkins-nginx-å®ç°æŒç»­é›†æˆ" class="headerlink" title="jenkins + nginx å®ç°æŒç»­é›†æˆ"></a>jenkins + nginx å®ç°æŒç»­é›†æˆ</h2><h3 id="æ­å»ºjenkins"><a href="#æ­å»ºjenkins" class="headerlink" title="æ­å»ºjenkins"></a>æ­å»ºjenkins</h3><p>jenkins æ˜¯ä¸€ä¸ªå¼€æºæŒç»­é›†æˆå·¥å…·ï¼Œå®‰è£…éå¸¸ç®€å•ï¼Œä¸ºäº†ç®¡ç†æ–¹ä¾¿ï¼Œè¿™é‡Œä½¿ç”¨ docker è¿›è¡Œå®‰è£…ã€‚</p>
<h4 id="å®‰è£…-docker"><a href="#å®‰è£…-docker" class="headerlink" title="å®‰è£… docker"></a>å®‰è£… docker</h4><p>centos å®‰è£… docker </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install docker</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨ docker æœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>

<h4 id="å®‰è£…-jenkins"><a href="#å®‰è£…-jenkins" class="headerlink" title="å®‰è£… jenkins"></a>å®‰è£… jenkins</h4><p>åˆ›å»º jenkins æ•°æ®æŒä¹…åŒ–ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> -p /data</span><br><span class="line">sudo <span class="built_in">chmod</span> 777 /data</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/jenkins_home</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡dockerå®¹å™¨å®‰è£…jenkins</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">  -u root \</span><br><span class="line">  --<span class="built_in">rm</span> \</span><br><span class="line">  --name jenkins-server \</span><br><span class="line">  -d \</span><br><span class="line">  -p 8080:8080 \</span><br><span class="line">  -p 50000:50000 \</span><br><span class="line">  -v /data/jenkins_home:/var/jenkins_home \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  registry.cn-hangzhou.aliyuncs.com/hzero-cli/jenkins</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å…³äº docker å‘½ä»¤çš„å­¦ä¹ å¯ä»¥çœ‹è¿™é‡Œ ğŸ‘‰ <a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-command-manual.html">Docker å‘½ä»¤å¤§å…¨</a></p>
</blockquote>
<p><img src="/images/15820942246314/15820967152707.jpg" alt="-w470"></p>
<p>ä¸Šé¢å‘½ä»¤è¿è¡Œå®Œæˆä¹‹åæˆ‘ä»¬å°±å·²ç»æˆåŠŸè¿è¡Œäº† jenkins æœåŠ¡</p>
<p>æˆ‘ä»¬å¯ä»¥æ‰“å¼€åœ°å€ https:&#x2F;&#x2F;<code>centosæœåŠ¡å™¨ip</code>:8080ï¼Œå¯ä»¥çœ‹åˆ° jenkins çš„ç•Œé¢ã€‚</p>
<blockquote>
<p>è¿™é‡Œçš„ <code>centosæœåŠ¡å™¨ip</code> å°±æ˜¯ä½ è‡ªå·±çš„æœåŠ¡å™¨ ipï¼Œåœ¨è¿™ä¸ªæ•™ç¨‹é‡Œé¢ï¼Œæˆ‘ä»¬æ¼”ç¤ºçš„æœåŠ¡å™¨ipæ˜¯ <code>172.22.0.4</code>ã€‚</p>
</blockquote>
<p><img src="/images/15820942246314/15820961636958.jpg" alt="-w1091"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦è·å–jenkinsåˆå§‹åŒ–å¯†ç ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it jenkins-server \</span><br><span class="line">    <span class="built_in">cat</span> /var/jenkins_home/secrets/initialAdminPassword</span><br></pre></td></tr></table></figure>
<p><img src="/images/15820942246314/15820967619904.jpg" alt="-w455"></p>
<p>è¿™é‡Œè¿”å›çš„ä¸€æ®µå­—ç¬¦ä¸²<code>6c46ccc61c804279a1017b743ab22aa4</code>å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å¯†ç </p>
<p>è¾“å…¥å¯†ç ä¹‹åï¼Œé€‰æ‹©å®‰è£…åˆå§‹åŒ–çš„æ’ä»¶</p>
<p><img src="/images/15820942246314/15820971428778.jpg" alt="-w1013"><br><img src="/images/15820942246314/15820972130894.jpg" alt="-w997"><br>æ’ä»¶å®‰è£…å¥½ä¹‹åï¼Œç³»ç»Ÿä¼šæç¤ºä½ è®¾ç½®ç”¨æˆ·åå¯†ç ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸è®¾ç½®ï¼Œç›´æ¥ç”¨ admin è´¦å·ã€‚é‡æ–°è¿›å…¥ jenkins ç•Œé¢ã€‚<br><img src="/images/15820942246314/15820988660511.jpg" alt="-w689"><br>ç‚¹å‡»è¾“å…¥è´¦å·é‡Œé¢ï¼Œè¿™é‡Œçš„å¯†ç å°±æ˜¯ä¸Šæ–‡è·å–åˆ°çš„ jenkins åˆå§‹åŒ–å¯†ç  <code>6c46ccc61c804279a1017b743ab22aa4</code>ï¼Œç‚¹å‡»ç™»å½•ï¼Œè¿›å…¥ç³»ç»Ÿ:<br><img src="/images/15820942246314/15820989609929.jpg" alt="-w696"></p>
<p>åˆ°æ­¤ä¸ºæ­¢ã€‚jenkins å°±ç®—æ˜¯å®‰è£…å¥½äº†</p>
<blockquote>
<p>æˆ‘ä»¬å¦‚æœæƒ³è¦å¸è½½ jenkins çš„è¯ï¼Œåªéœ€è¦è¿è¡Œ <code>docker rm -f jenkins-server</code> å°±å¯ä»¥äº†ã€‚</p>
<p>å› ä¸ºæˆ‘ä»¬é…ç½®äº† jenkins æ•°æ®æŒä¹…åŒ–çš„ç›®å½• <code>/data/jenkins_home</code>ï¼Œ åªè¦è¿™ä¸ªæ–‡ä»¶å¤¹è¿˜åœ¨ï¼Œjenkins é…ç½®å°±å¯ä»¥ä¸€ç›´ä¿ç•™ï¼Œä¸‹æ¬¡æƒ³è¿è¡Œ jenkins æ˜¯ï¼Œè¿è¡Œä¸Šæ–‡å®‰è£… jenkins çš„ docker run å‘½ä»¤å°±å¯ä»¥æ¢å¤ docker è¿è¡Œäº†ã€‚</p>
</blockquote>
<h3 id="é…ç½®-jenkins-çš„-nodejs-æ’ä»¶"><a href="#é…ç½®-jenkins-çš„-nodejs-æ’ä»¶" class="headerlink" title="é…ç½® jenkins çš„ nodejs æ’ä»¶"></a>é…ç½® jenkins çš„ nodejs æ’ä»¶</h3><p>å®‰è£…å®Œ jenkins ä¹‹åï¼Œ éœ€è¦é…ç½®ä¸€ä¸‹ nodejs æ’ä»¶ï¼Œåé¢æ‰èƒ½è®© jenkins è·‘å‰ç«¯æŒç»­é›†æˆä»»åŠ¡ã€‚</p>
<p>ç‚¹å‡» <strong>ç³»ç»Ÿç®¡ç†</strong>  è¿›å…¥ jenkins ç³»ç»Ÿç®¡ç†é¡µé¢<br><img src="/images/15820942246314/15820991787999.jpg" alt="-w315"></p>
<p>ç‚¹å‡» <strong>æ’ä»¶ç®¡ç†</strong> è¿›å…¥æ’ä»¶ç®¡ç†<br><img src="/images/15820942246314/15821002348355.jpg" alt="-w1021"></p>
<p>è¿›å…¥ <strong>å¯é€‰æ’ä»¶</strong> é€‰é¡¹å¡ï¼Œæœç´¢å¹¶å®‰è£… <code>nodejs</code> æ’ä»¶<br><img src="/images/15820942246314/15821180399210.jpg" alt="-w1120"></p>
<p>å‹¾é€‰ <code>å®‰è£…å®Œæˆåé‡å¯é€‰é¡¹</code>ï¼Œå®‰è£…å®Œæ’ä»¶ä¹‹å jenkins ä¼š <strong>è‡ªåŠ¨é‡å¯</strong></p>
<p><img src="/images/15820942246314/15821181345609.jpg" alt="-w554"></p>
<p>è¿›å…¥ <strong>å…¨å±€å·¥å…·é…ç½®</strong> é…ç½® nodejs å…¨å±€å·¥å…·</p>
<p><img src="/images/15820942246314/15821182607013.jpg" alt="-w931"></p>
<p>ç‚¹å‡» <strong>æ–°å¢ NodeJS</strong> æŒ‰é”®æ–°å¢ä¸€ä¸ª nodejs å…¨å±€å·¥å…·ï¼Œå‹¾é€‰ <strong>è‡ªåŠ¨å®‰è£…</strong></p>
<p><img src="/images/15820942246314/15821185123655.jpg" alt="15821185123655"></p>
<p>æ³¨æ„:</p>
<ul>
<li>å®‰è£… nodejs æ—¶éœ€è¦å®‰è£…ä¸¤ä¸ª node å…¨å±€å‘½ä»¤ <code>yarn</code> å’Œ <code>lerna</code>, ç„¶åç‚¹å‡»ä¿å­˜ã€‚</li>
</ul>
<h3 id="æµ‹è¯•-nodejs-æ’ä»¶"><a href="#æµ‹è¯•-nodejs-æ’ä»¶" class="headerlink" title="æµ‹è¯• nodejs æ’ä»¶"></a>æµ‹è¯• nodejs æ’ä»¶</h3><p>æˆ‘ä»¬å®‰è£…å®Œäº† nodejs æ’ä»¶ä¹‹åï¼Œå…ˆå›åˆ°é¦–é¡µ æ–°å»ºä¸€ä¸ª jenkins ä»»åŠ¡æµ‹è¯•ä¸€ä¸‹ nodejsã€‚</p>
<p>ç‚¹å‡» <strong>åˆ›å»ºä¸€ä¸ªæ–°ä»»åŠ¡</strong> æ‰“å¼€ä»»åŠ¡ç¼–è¾‘ç•Œé¢<br><img src="/images/15820942246314/15821185754719.jpg" alt="-w630"><br>é€‰æ‹© <strong>æ„å»ºè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®</strong>ï¼Œ è¾“å…¥ä¸€ä¸ªä»»åŠ¡åå­—<code>test-node-demo</code>:<br><img src="/images/15820942246314/15821187127960.jpg" alt="-w718"></p>
<p>åœ¨æ„å»ºç¯å¢ƒè¿™é‡Œé€‰æ‹©æˆ‘ä»¬åˆšåˆšé…ç½®çš„ nodejs å…¨å±€å·¥å…·</p>
<p><img src="/images/15820942246314/15821187744475.jpg" alt="-w734"></p>
<p>åœ¨æ„å»ºè¿™é‡Œ ç‚¹å‡» <strong>å¢åŠ æ„å»ºæ­¥éª¤</strong> ï¼Œåœ¨å¼¹å‡ºçš„é€‰é¡¹ä¸­é€‰æ‹© <strong>æ‰§è¡Œshell</strong> ï¼š</p>
<p><img src="/images/15820942246314/15821188924270.jpg" alt="-w359"></p>
<p>åœ¨å‘½ä»¤è¾“å…¥æ¡†ä¸­è¾“å…¥,ç„¶åç‚¹å‡»ä¿å­˜æŒ‰é’®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -e &#x27;console.log(&quot;Hello Hzero!&quot;);&#x27;</span><br><span class="line">node --version</span><br></pre></td></tr></table></figure>
<p><img src="/images/15820942246314/15821190991233.jpg" alt="-w758"></p>
<p>ç„¶åç‚¹å‡»è¿™ä¸ªä»»åŠ¡çš„ <strong>ç«‹å³æ„å»º</strong> æŒ‰é’®</p>
<p>æ„å»ºæ—¶ï¼Œåœ¨ä¸‹é¢ä¼šå‡ºç°ä¸€ä¸ªè¿›åº¦æ¡ï¼Œç‚¹å‡»è¿›åº¦æ¡ å¯ä»¥çœ‹æ‰§è¡Œçš„æ—¥å¿—</p>
<p><img src="/images/15820942246314/15821191550792.jpg" alt="-w624"></p>
<p>è¿›å…¥æ—¥å¿—ä¹‹åï¼Œå°†çœ‹åˆ°çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯</p>
<p><img src="/images/15820942246314/15821240438051.jpg" alt="-w1061"></p>
<p>åˆ°æ­¤ï¼Œnodejs æ’ä»¶æµ‹è¯•æˆåŠŸï¼</p>
<h3 id="å®‰è£…-nginx"><a href="#å®‰è£…-nginx" class="headerlink" title="å®‰è£… nginx"></a>å®‰è£… nginx</h3><p>centos å®‰è£… nginx ä¹Ÿéå¸¸ç®€å• ï¼Œä¸€å¥å‘½ä»¤ <code>sudo yum install nginx</code> å°±èƒ½æå®šï¼Œ ä½†æ˜¯è¿™æ ·å®‰è£… nginx ä¹‹åï¼Œé…ç½®ç®¡ç†å’Œnginxå‡çº§éƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç”¨ docker æ¥å®‰è£… nginx ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸¤ä¸ªæ–‡ä»¶ç›®å½•ï¼Œç”¨æ¥ä¿å­˜ nginx çš„éƒ¨ç½²æ–‡ä»¶å’Œ nginx çš„é…ç½®</p>
<ul>
<li><code>/data/nginx/wwwroot</code> nginx çš„éƒ¨ç½²æ–‡ä»¶å¤¹</li>
<li><code>/data/nginx/nginx_hzero.conf</code> hzero çš„ nginx é…ç½®</li>
</ul>
<p>é¦–å…ˆåˆ›å»º nginx æ•°æ®æŒä¹…åŒ–æ–‡ä»¶å¤¹å’Œ é…ç½®ä¿å­˜æ–‡ä»¶å¤¹,</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> -p /data/nginx/wwwroot</span><br><span class="line">sudo <span class="built_in">mkdir</span> -p /data/nginx/cfg</span><br></pre></td></tr></table></figure>

<p><img src="/images/15820942246314/15821112605783.jpg" alt="-w380"></p>
<p>åˆ›å»º nginx é…ç½®æ–‡ä»¶, ä¿å­˜åœ¨ <code>/data/nginx/cfg/nginx_hzero.conf</code></p>
<p>åœ¨å‘½ä»¤è¡Œè¿è¡Œä¸‹é¢å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /data/nginx/cfg/nginx_hzero.conf</span></span><br><span class="line"></span><br><span class="line">sudo -s <span class="comment"># è¿›å…¥rootç”¨æˆ·æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; /data/nginx/cfg/nginx_hzero.conf &lt;&lt; <span class="string">END</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">server &#123;</span></span><br><span class="line"><span class="string">    listen       80;</span></span><br><span class="line"><span class="string">    server_name  localhost;</span></span><br><span class="line"><span class="string">    root   /usr/share/nginx/html/dist;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    location / &#123;</span></span><br><span class="line"><span class="string">      try_files \$uri /index.html;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    error_page   500 502 503 504  /50x.html;</span></span><br><span class="line"><span class="string">    location = /50x.html &#123;</span></span><br><span class="line"><span class="string">        root   /usr/share/nginx/html/dist;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    # Media: images, icons, video, audio, HTC</span></span><br><span class="line"><span class="string">    location ~* \.(jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc)$ &#123;</span></span><br><span class="line"><span class="string">    expires 1M;</span></span><br><span class="line"><span class="string">    access_log off;</span></span><br><span class="line"><span class="string">    add_header Cache-Control &quot;public&quot;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    # CSS and Javascript</span></span><br><span class="line"><span class="string">    location ~* \.(css|js)$ &#123;</span></span><br><span class="line"><span class="string">    expires 1y;</span></span><br><span class="line"><span class="string">    access_log off;</span></span><br><span class="line"><span class="string">    add_header Cache-Control &quot;public&quot;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">END</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/images/15820942246314/15821112926505.jpg" alt="-w590"></p>
<p>è¿è¡Œnginxé•œåƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">  -u root \</span><br><span class="line">  --<span class="built_in">rm</span> \</span><br><span class="line">  --name nginx \</span><br><span class="line">  -d \</span><br><span class="line">  -p 40080:80 \</span><br><span class="line">  -v /data/nginx/cfg/:/etc/nginx/conf.d/ \</span><br><span class="line">  -v /data/nginx/wwwroot/:/usr/share/nginx/html/ \</span><br><span class="line">  nginx</span><br></pre></td></tr></table></figure>

<p><img src="/images/15820942246314/15821113566156.jpg" alt="-w458"></p>
<p>æ·»åŠ æµ‹è¯•æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> -p /data/nginx/wwwroot/dist</span><br><span class="line">sudo <span class="built_in">echo</span> Hello Nginx &gt; /data/nginx/wwwroot/dist/test.txt</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯• nginx è¿è¡Œæ•ˆæœ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://172.22.0.4:40080/test.txt</span><br></pre></td></tr></table></figure>

<p><img src="/images/15820942246314/15821113849756.jpg" alt="-w472"></p>
<p>å¦‚æœèƒ½æ˜¾ç¤º Hello Nginx è¯´æ˜ nginx å®‰è£…æˆåŠŸ</p>
<h3 id="é…ç½®-jenkins-æŒç»­é›†æˆä»»åŠ¡"><a href="#é…ç½®-jenkins-æŒç»­é›†æˆä»»åŠ¡" class="headerlink" title="é…ç½® jenkins æŒç»­é›†æˆä»»åŠ¡"></a>é…ç½® jenkins æŒç»­é›†æˆä»»åŠ¡</h3><h4 id="æ„å»º"><a href="#æ„å»º" class="headerlink" title="æ„å»º"></a>æ„å»º</h4><p>é…ç½® jenkins ä»»åŠ¡ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå‡†å¤‡ä¸€ä¸ª hzero-front å·¥ç¨‹çš„ä»£ç ä»“åº“åœ°å€ï¼š<br><code>https://code.choerodon.com.cn/hft/hzero-front-demo.git</code></p>
<p>å›åˆ° jenkins é¦–é¡µ æ–°å»ºä¸€ä¸ª jenkins ä»»åŠ¡ã€‚</p>
<p>ç‚¹å‡» <strong>åˆ›å»ºä¸€ä¸ªæ–°ä»»åŠ¡</strong> æ‰“å¼€ä»»åŠ¡ç¼–è¾‘ç•Œé¢<br><img src="/images/15820942246314/15821185754719.jpg" alt="-w630"><br>é€‰æ‹© <strong>æ„å»ºè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®</strong>ï¼Œ è¾“å…¥ä¸€ä¸ªä»»åŠ¡åå­—<code>hzero-front-ci</code>:</p>
<p>ç‚¹å‡»ä¿å­˜åä¼šè¿›å…¥ä»»åŠ¡ç¼–è¾‘é¡µé¢ï¼š</p>
<p><img src="/images/15820942246314/15821309390419.jpg" alt="-w1054"></p>
<p>åœ¨ä»»åŠ¡ç¼–è¾‘ç•Œé¢çš„æºä»£ç ç®¡ç† é€‰æ‹© git é€‰é¡¹<br>å®‰è£…å›¾ç‰‡å¡«å†™ä¸‹é¢ä¿¡æ¯ï¼š</p>
<ul>
<li>Repository URLï¼š è¾“å…¥ä»£ç åº“åœ°å€ï¼ˆ<code>https://code.choerodon.com.cn/hft/hzero-front-demo.git</code>ï¼‰</li>
<li>Credentialsï¼šæ·»åŠ  code.choerodon.com.cn çš„è´¦å·å¯†ç </li>
</ul>
<p>åœ¨ç¼–è¯‘ç¯å¢ƒè®¾ç½®é‡Œé¢å‹¾é€‰ä¸Š nodejs å·¥å…·ã€‚</p>
<p><img src="/images/15820942246314/15821311690599.jpg" alt="-w980"></p>
<p>æ·»åŠ ä¸€ä¸ªæ„å»ºæ­¥éª¤ <code>æ‰§è¡Œ shell</code><br><img src="/images/15820942246314/15821312331832.jpg" alt="-w515"></p>
<p>è¾“å…¥ä¸‹é¢çš„ shell è„šæœ¬:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">yarn install</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; src/config/.env.production.yml.local  &lt;&lt; <span class="string">END</span></span><br><span class="line"><span class="string">BASE_PATH: /</span></span><br><span class="line"><span class="string">PLATFORM_VERSION: SAAS</span></span><br><span class="line"><span class="string">CLIENT_ID: localhost</span></span><br><span class="line"><span class="string">GENERATE_SOURCEMAP: false</span></span><br><span class="line"><span class="string">API_HOST: http://backend.hft.jajabjbj.top</span></span><br><span class="line"><span class="string">WEBSOCKET_HOST: ws://ws.hft.jajabjbj.top</span></span><br><span class="line"><span class="string">SKIP_TS_CHECK_IN_START: false</span></span><br><span class="line"><span class="string">ENABLE_VUE_SUPPORT: false</span></span><br><span class="line"><span class="string">SKIP_ESLINT_CHECK_IN_START: false</span></span><br><span class="line"><span class="string">END</span></span><br><span class="line">yarn run build:production</span><br><span class="line">tar -zcf dist.tar.gz ./dist</span><br></pre></td></tr></table></figure>

<p><img src="/images/15820942246314/15821804456276.jpg" alt="-w961"></p>
<p>ç‚¹å‡»ä¿å­˜ã€‚</p>
<p>ä¸‹ä¸€æ­¥ç„¶åç‚¹å‡» ç«‹å³æ„å»ºï¼Œè¿™é‡Œä¼šæ„å»ºå¹¶ç”Ÿæˆ dist æ–‡ä»¶</p>
<p><img src="/images/15820942246314/15821313783678.jpg" alt="-w711"></p>
<h4 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h4><p>æ„å»ºå®Œæˆç”Ÿæˆäº† dist æ–‡ä»¶ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬è¦æŠŠ æ„å»ºç”Ÿæˆçš„æ–‡ä»¶éƒ¨ç½²åˆ° nginx çš„ www ç›®å½• <code>/data/nginx/wwwroot</code></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬é…ç½®ä¸€ä¸‹ dist éƒ¨ç½²æµç¨‹</p>
<p>éƒ¨ç½²é€šå¸¸éƒ½æ˜¯æŒ‡æŠŠæ„å»ºå¥½çš„ dist æ–‡ä»¶éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œéƒ¨ç½²çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ ftpã€ æ„å»º dockerç­‰ã€ssh ï¼Œ è¿™é‡Œæˆ‘ä»¬æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•é€šè¿‡ ssh è¿œç¨‹éƒ¨ç½² dist æ–‡ä»¶åˆ° nginx æœåŠ¡å™¨ä¸Šã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®‰è£…ä¸€ä¸ª jenkins æ’ä»¶ <code>Publish Over SSH</code>ã€‚</p>
<p><img src="/images/15820942246314/15821775655990.jpg" alt="-w814"></p>
<p>æ’ä»¶çš„å®‰è£…æ–¹æ³•ä¸Šæ–‡ä¸­æœ‰æåˆ°ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p>
<p>å®‰è£…å¥½ä¹‹åï¼Œæ‰“å¼€ <strong>ç³»ç»Ÿç®¡ç†</strong> &gt; <strong>é…ç½®ä¸­å¿ƒ</strong><br><img src="/images/15820942246314/15821779486366.jpg" alt="-w793"></p>
<p>æŠŠ nginx æœåŠ¡å™¨çš„ä¿¡æ¯ æ·»åŠ åˆ° <code>Publish Over SSH</code> çš„ ssh é…ç½®ã€‚</p>
<p><img src="/images/15820942246314/15821778504635.jpg" alt="-w1413"></p>
<p>å¯¹å…³é”®é…ç½®é¡¹çš„è§£é‡Šï¼š</p>
<ul>
<li><strong>name</strong>: ç»™æœåŠ¡å™¨èµ·ä¸€ä¸ªåå­—ï¼Œåœ¨åé¢è®¾ç½®ä»»åŠ¡æ—¶ä¼šç”¨åˆ°è¿™ä¸ªåå­—ã€‚</li>
<li><strong>Hostname</strong>: sshd æœåŠ¡å™¨çš„ipåœ°å€, ä¹Ÿå°±æ˜¯ nginx æœåŠ¡å™¨ipåœ°å€ã€‚</li>
<li><strong>Remote Directory</strong>: è¿™é‡Œæ˜¯è®¾ç½®æœåŠ¡å™¨ä¸Šä¼ ç›®å½•ï¼Œç”±äºåœ¨ jenkins ä»»åŠ¡é‡Œé¢å¯ä»¥é…ç½®ï¼Œ ä¸ºäº†ä¸å¼•èµ·è¯¯è§£ï¼Œè¿™é‡Œè®¾ç½®æˆ <code>/</code> å°±å¯ä»¥äº†ã€‚</li>
<li><strong>Passphrase&#x2F;Password</strong>: è¿™é‡Œæ˜¯æœåŠ¡å™¨ ssh ç™»å½•å¯†ç ï¼Œå¦‚æœæ˜¯é€šè¿‡ç§é’¥è¿æ¥æœåŠ¡å™¨ï¼Œå¯ä»¥ä¸è¾“å…¥å¯†ç ã€‚</li>
<li><strong>Key</strong>: è¿™é‡Œæ˜¯æœåŠ¡å™¨çš„ç§é’¥æ–‡ä»¶å†…å®¹ã€‚å¦‚æœä½ æ˜¯é€šè¿‡ å¯†ç  è¿æ¥ ssh æœåŠ¡å™¨çš„è¯ï¼Œå¯ä»¥ä¸å¡«ç§é’¥ã€‚</li>
</ul>
<p>ç„¶åæ‰“å¼€æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ jenkins ä»»åŠ¡ï¼Œç‚¹å‡»é…ç½®æŒ‰é’®ï¼Œè¿›å…¥ä»»åŠ¡ç¼–è¾‘é¡µé¢ã€‚</p>
<p><img src="/images/15820942246314/15821318511535.jpg" alt="-w500"></p>
<p>åˆ° <code>Post-build Actions</code> é…ç½®éƒ¨åˆ†æ·»åŠ ä¸€ä¸ª æ„å»ºåçš„éƒ¨ç½²æµç¨‹ã€‚<br><img src="/images/15820942246314/15821781519316.jpg" alt="-w651"></p>
<p>ç„¶åè¾“å…¥ç›¸åº”çš„é…ç½®</p>
<p><img src="/images/15820942246314/15821781898781.jpg" alt="-w968"></p>
<p>å¯¹å…³é”®é…ç½®é¡¹çš„è§£é‡Šï¼š</p>
<ul>
<li><strong>name</strong>: ä¸Šæ–‡åœ¨ <strong>ç³»ç»Ÿç®¡ç†</strong> &gt; <strong>é…ç½®ä¸­å¿ƒ</strong> ä¸­é…ç½®çš„ ssh æœåŠ¡å™¨åå­—ã€‚</li>
<li><strong>Source files</strong>: åˆ¶å®šä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ–‡ä»¶ï¼Œæ³¨æ„è¿™é‡Œçš„æ–‡ä»¶æ˜¯ä¸Šé¢æˆ‘ä»¬é…ç½®çš„æ„å»ºè„šæœ¬äº§ç”Ÿçš„æ–‡ä»¶ã€‚</li>
<li><strong>Remote directory</strong>: è¿™ä¸ªæ˜¯ä¸Šä¼ åˆ°è¿œç¨‹æœåŠ¡å™¨ä½ç½®ï¼Œä¸Šä¼ ä¸Šå»çš„æ–‡ä»¶è¿˜æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œåé¢è¿˜æœ‰åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡ŒèŠ‚çº¦å‘½ä»¤</li>
<li><strong>Exec command</strong>: åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ shell å‘½ä»¤</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /data/nginx/wwwroot</span><br><span class="line">sudo <span class="built_in">rm</span> -rf dist</span><br><span class="line">sudo tar -zxf dist.tar.gz</span><br></pre></td></tr></table></figure>

<p>ç„¶åç‚¹å‡»ä¿å­˜ï¼Œå†æ„å»ºä¸€æ¬¡ã€‚<br><img src="/images/15820942246314/15821793949244.jpg" alt="-w1156"></p>
<p>çœ‹ä¸‹æ„å»ºæ—¥å¿—ã€‚æç¤ºå‘å¸ƒæˆåŠŸã€‚</p>
<p><img src="/images/15820942246314/15821794072373.jpg" alt="-w525"></p>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥ åœ¨æµè§ˆå™¨è¾“å…¥ä¸€ä¸‹ nginx æœåŠ¡å™¨åœ°å€ï¼Œ è¯•è¯•æœåŠ¡æ˜¯å¦æˆåŠŸã€‚</p>
<h4 id="é…ç½®è‡ªåŠ¨æŒç»­é›†æˆ"><a href="#é…ç½®è‡ªåŠ¨æŒç»­é›†æˆ" class="headerlink" title="é…ç½®è‡ªåŠ¨æŒç»­é›†æˆ"></a>é…ç½®è‡ªåŠ¨æŒç»­é›†æˆ</h4><p>å¦‚æœæƒ³å®ç°å®Œå…¨è‡ªåŠ¨çš„æŒç»­é›†æˆï¼Œè¿˜éœ€è¦é…ç½®ä¸€ä¸ªåœ°æ–¹</p>
<p>æ‰“å¼€ä»»åŠ¡é…ç½®è®¾ç½®ä¸€ä¸ªè§¦å‘é€‰é¡¹ <code>Poll SCM</code>ï¼Œè®¾ç½® <code>Schedule</code> è§„åˆ™ä¸º: <code>H/15 * * * *</code></p>
<p><img src="/images/15820942246314/15821800915046.jpg" alt="-w1229"></p>
<p>è¿™é‡Œé…ç½®é¡¹çš„æ„æ€æ˜¯ï¼šæ¯ 15 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ git æºä»£ç ä»“åº“æ˜¯å¦æœ‰æ–°çš„å˜æ›´ï¼Œå¦‚æœæœ‰å°±æ‰§è¡Œæ„å»ºä»»åŠ¡ã€‚</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://tool.lu/crontab/">å…³äº cronjob è¡¨è¾¾å¼çš„å­¦ä¹ </a></p>
</blockquote>
<h2 id="jenkins-gh-pages-å®ç°æŒç»­é›†æˆ"><a href="#jenkins-gh-pages-å®ç°æŒç»­é›†æˆ" class="headerlink" title="jenkins + gh-pages å®ç°æŒç»­é›†æˆ"></a>jenkins + gh-pages å®ç°æŒç»­é›†æˆ</h2><p>å¦‚æœæ²¡æœ‰ nginx æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠ dist éƒ¨ç½²åˆ° gh-pages ä¸Šã€‚</p>
<p>è€ƒè™‘åˆ° github çš„ gh-pages ç½‘é€Ÿåœ¨å›½å†…æœ‰äº›æ…¢ï¼Œ æœ¬æ•™ç¨‹å°±ç”¨å›½å†…çš„ gitee åšä¸€ä¸ªç¤ºèŒƒã€‚</p>
<blockquote>
<p>giteeç½‘ç«™: <a target="_blank" rel="noopener" href="https://gitee.com/">https://gitee.com/</a></p>
</blockquote>
<p>é¦–å…ˆæˆ‘ä»¬åœ¨ gitee ä¸Šé¢æ³¨å†Œå¥½è´¦å·ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ªä»£ç ä»“åº“ã€‚</p>
<p><img src="/images/15820942246314/15821819693074.jpg" alt="-w786"></p>
<p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªä»£ç ä»“åº“åœ°å€ï¼š<code>https://gitee.com/hzero-cli/hzero-front-demo-dist.git</code></p>
<p>éƒ¨ç½²åˆ° gh-pages ä¸Šé¢æˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€ä¸ª npm å·¥å…·</p>
<ul>
<li>gh-pages: <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/gh-pages">gh-pages æ–‡æ¡£åœ°å€</a></li>
</ul>
<p>æŠŠè¿™ä¸ªå·¥å…·é…ç½®åˆ° nodejs çš„å…¨å±€å·¥å…·ä¸Šé¢ï¼š</p>
<p><img src="/images/15820942246314/15821830690021.jpg" alt="-w910"></p>
<p>é…ç½®å¥½å·¥å…·ä¹‹åï¼Œå¼€å§‹åˆ›å»º jenkins ä»»åŠ¡ã€‚</p>
<p>ä¸ºäº†ç®€ä¾¿ï¼Œæˆ‘ä»¬åŸºäºä¹‹å‰çš„æŒç»­é›†æˆä»»åŠ¡åˆ›å»ºä¸€ä¸ªæ–°çš„æŒç»­é›†æˆä»»åŠ¡ã€‚</p>
<p>ç‚¹å‡» <strong>æ–°å»ºä»»åŠ¡</strong> æŒ‰é’®<br><img src="/images/15820942246314/15821821404080.jpg" alt="-w670"></p>
<p>ä¸ºä»»åŠ¡èµ·ä¸€ä¸ªæ–°åå­—ï¼š <code>hzero-front-ci-gitee</code></p>
<p><img src="/images/15820942246314/15821822551782.jpg" alt="-w1074"></p>
<p>æ³¨æ„è¿™é‡Œæˆ‘ä»¬è¦é€‰æ‹© <strong>Copy from</strong>, è¾“å…¥å‰é¢åˆ›å»ºçš„ä»»åŠ¡åå­—ï¼š<code>hzero-front-ci</code></p>
<p>ç‚¹å‡» ok ï¼Œè¿›å…¥æ„å»ºé…ç½®éƒ¨åˆ†ã€‚<br><img src="/images/15820942246314/15821827533997.jpg" alt="-w1201"></p>
<p>ä¿®æ”¹æ„å»ºè„šæœ¬ï¼Œæ·»åŠ  gh-pages éƒ¨ç½²å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.email <span class="string">&quot;you@example.com&quot;</span></span><br><span class="line">git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line">gh-pages -r https://hzero-cli:abcd1234@gitee.com/hzero-cli/hzero-front-demo-dist.git   -b gh-pages   -d dist</span><br></pre></td></tr></table></figure>

<p>ç„¶ååˆ é™¤ä» <code>hzero-front-ci</code> ä»»åŠ¡å¤åˆ¶è¿‡æ¥çš„ sshéƒ¨ç½² é…ç½®</p>
<p>ä¿å­˜ï¼Œç‚¹å‡»ç«‹å³æ„å»ºã€‚</p>
<p>è¿™æ ·æ„å»ºç”Ÿæˆçš„ dist å°±å¯ä»¥å‘å¸ƒåˆ° gitee ä»£ç ä»“åº“äº†ã€‚</p>
<p><img src="/images/15820942246314/15821861555894.jpg" alt="-w820"></p>
<p>è¿™é‡Œä¼šå¤šä¸€ä¸ªåˆ†æ”¯ï¼Œå°±æ˜¯æˆ‘ä»¬éƒ¨ç½²ä¸Šå»çš„æ–‡ä»¶ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ç»™ gitee ä»£ç ä»“åº“è®¾ç½®ä¸€ä¸‹ gh-pages çš„ http æœåŠ¡ã€‚</p>
<p>ç‚¹å‡» <strong>æœåŠ¡</strong> &gt; <strong>Gitee Pages</strong></p>
<p><img src="/images/15820942246314/15821862428010.jpg" alt="-w973"></p>
<p>è®¾ç½®éƒ¨ç½²åˆ†æ”¯ä¸º gh-pages ,ç„¶åç‚¹å‡»å¼€å§‹æŒ‰é’®</p>
<p>è¿è¡ŒæˆåŠŸä¹‹åï¼Œ æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ª http è®¿é—®åœ°å€ï¼š<code>http://hzero-cli.gitee.io/hzero-front-demo-dist/</code></p>
<p>ä½†æ˜¯è®¿é—®æ—¶ï¼Œ console è¿˜æ˜¯ä¼šæŠ¥é”™: </p>
<p><img src="/images/15820942246314/15821864231685.jpg" alt="-w1147"></p>
<p>è¿™æ˜¯å› ä¸º gitee çš„ gh-pages æä¾›çš„ http åœ°å€æœ‰ä¸€ä¸ªæ ¹è·¯å¾„(public_path)ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹æ„å»ºçš„ç¯å¢ƒå˜é‡ï¼Œæ‰“å¼€ä»»åŠ¡çš„æ„å»ºé…ç½®ä¿®æ”¹ç¯å¢ƒå˜é‡ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">PUBLIC_URL:</span> <span class="string">/hzero-front-demo-dist/</span></span><br><span class="line"><span class="attr">BASE_PATH:</span> <span class="string">/hzero-front-demo-dist/</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ä¸€ä¸‹ BASE_PATH å’Œ PUBLIC_URL çš„åŒºåˆ«ã€‚</p>
<ul>
<li><strong>PUBLIC_URL</strong> : ä¼šå½±å“èµ„æºåŠ è½½è·¯å¾„ï¼Œåœ¨èµ„æºåŠ è½½è·¯å¾„å‰é¢åŠ ä¸€å±‚æ ¹è·¯å¾„ã€‚</li>
<li><strong>BASE_PATH</strong> : ä¼šå½±å“æµè§ˆå™¨çš„åœ°å€æ æ ¹è·¯å¾„ã€‚åœ¨åœ°å€æ æ˜¾ç¤ºçš„åœ°å€ä¸ŠåŠ ä¸€å±‚æ ¹è·¯å¾„ã€‚</li>
</ul>
<p>è™½ç„¶ BASE_PATH ä¸ä¼šå½±å“èµ„æºåŠ è½½è·¯å¾„ï¼Œä½†æ˜¯æˆ‘ä»¬è¿›å…¥é¡µé¢ä¹‹ååˆ·æ–°ï¼Œå¿…é¡»æµè§ˆå™¨çš„åœ°å€æ æ˜¯ä»¥ <code>http://hzero-cli.gitee.io/hzero-front-demo-dist/</code> ä¸ºå‰ç¼€ï¼Œæ‰€ä»¥è¦åŠ ä¸€ä¸‹ BASE_PATH çš„é…ç½®ã€‚</p>
<p>æ¸…é™¤æ„å»ºç¼“å­˜ï¼Œç„¶åç‚¹å‡»é‡æ–°æ„å»º<br><img src="/images/15820942246314/15821843422297.jpg" alt="-w369"></p>
<blockquote>
<p>æ³¨æ„: ç”±äº hzero-cli é»˜è®¤å¼€å¯äº†å¢é‡æ›´æ–°ï¼Œ æ‰€ä»¥ä¿®æ”¹äº†ç¯å¢ƒå˜é‡ä¹‹åï¼Œéœ€è¦æ¸…ç©ºå½“å‰æ„å»ºä»»åŠ¡çš„ç¼“å­˜ã€‚</p>
</blockquote>
<p>å¦‚æœä½ è®¿é—®é¡µé¢ï¼Œç¬¬äºŒæ¬¡åˆ·æ–°è¿˜ä¼šæœ‰ 404 çš„é—®é¢˜</p>
<p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ gh-pages å’Œ nginx é…ç½® ä¸ä¸€æ ·ã€‚<br>nginx ä¸Šé¢é…ç½®äº†ä¸€æ®µä»£ç ï¼š </p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> / &#123;</span><br><span class="line">  <span class="attribute">try_files</span> <span class="variable">$uri</span> /index.html;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰äº†è¿™æ®µä»£ç ï¼Œ æœåŠ¡å™¨å°±ä¼šè·¯å¾„æ‰¾ä¸åˆ°çš„httpè¯·æ±‚é‡æ–°å®šä½åˆ° &#x2F;index.html</p>
<p>ä½†æ˜¯ gh-pages çš„åŸç†æ˜¯: å¦‚æœå½“å‰ http è¯·æ±‚è·¯å¾„å®šä½ä¸åˆ°ä»“åº“çš„æ–‡ä»¶ï¼Œå°±è¿”å› 404.html çš„å†…å®¹ã€‚</p>
<p>æ‰€ä»¥ä¸ºäº†èƒ½è®©é¡µé¢æ­£å¸¸æ˜¾ç¤ºï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨è„šæœ¬æ„å»ºå®Œæˆä¹‹å åŠ ä¸€è¡Œä»£ç  <code>cp dist/index.html dist/404.html</code><br>è®©æµè§ˆå™¨èƒ½è·å–åˆ° index.html ã€‚</p>
<p>æœ€åè„šæœ¬ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">yarn install</span><br><span class="line"><span class="built_in">cat</span> &gt; src/config/.env.production.local.yml  &lt;&lt; <span class="string">END</span></span><br><span class="line"><span class="string">PUBLIC_URL: /hzero-front-demo-dist/</span></span><br><span class="line"><span class="string">BASE_PATH: /hzero-front-demo-dist/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PLATFORM_VERSION: SAAS</span></span><br><span class="line"><span class="string">CLIENT_ID: localhost</span></span><br><span class="line"><span class="string">GENERATE_SOURCEMAP: false</span></span><br><span class="line"><span class="string">API_HOST: http://backend.hft.jajabjbj.top</span></span><br><span class="line"><span class="string">WEBSOCKET_HOST: ws://ws.hft.jajabjbj.top</span></span><br><span class="line"><span class="string">SKIP_TS_CHECK_IN_START: false</span></span><br><span class="line"><span class="string">ENABLE_VUE_SUPPORT: false</span></span><br><span class="line"><span class="string">SKIP_ESLINT_CHECK_IN_START: false</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">END</span></span><br><span class="line"></span><br><span class="line">yarn run build:production</span><br><span class="line"><span class="built_in">cp</span> dist/index.html dist/404.html</span><br><span class="line"></span><br><span class="line">git config --global user.email <span class="string">&quot;you@example.com&quot;</span></span><br><span class="line">git config --global user.name <span class="string">&quot;Your Name&quot;</span></span><br><span class="line">gh-pages-clean</span><br><span class="line">gh-pages -r https://hzero-cli:abcd1234@gitee.com/hzero-cli/hzero-front-demo-dist.git \</span><br><span class="line">  -b gh-pages \</span><br><span class="line">  -d dist</span><br></pre></td></tr></table></figure>

<p>æ¸…é™¤æ„å»ºç¼“å­˜ä¹‹åï¼Œç‚¹å‡»é‡æ–°æ„å»º, æ„å»ºæˆåŠŸä¼šè‡ªåŠ¨éƒ¨ç½²ï¼Œéƒ¨ç½²å®Œæˆä¹‹åå°±å¯ä»¥è®¿é—®ï¼š <a target="_blank" rel="noopener" href="http://hzero-cli.gitee.io/hzero-front-demo-dist">http://hzero-cli.gitee.io/hzero-front-demo-dist</a> äº†</p>

        
            <div id="toc-article">
                
  <div class="widget-wrap" id="toc-wrap">
    <h3 class="widget-title"><i class="fa fa-toc"></i> æ–‡ç« ç›®å½•</h3>
    <div class="widget">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#jenkins-nginx-%E5%AE%9E%E7%8E%B0%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90"><span class="toc-text">jenkins + nginx å®ç°æŒç»­é›†æˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BAjenkins"><span class="toc-text">æ­å»ºjenkins</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-docker"><span class="toc-text">å®‰è£… docker</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-jenkins"><span class="toc-text">å®‰è£… jenkins</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-jenkins-%E7%9A%84-nodejs-%E6%8F%92%E4%BB%B6"><span class="toc-text">é…ç½® jenkins çš„ nodejs æ’ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-nodejs-%E6%8F%92%E4%BB%B6"><span class="toc-text">æµ‹è¯• nodejs æ’ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-nginx"><span class="toc-text">å®‰è£… nginx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-jenkins-%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E4%BB%BB%E5%8A%A1"><span class="toc-text">é…ç½® jenkins æŒç»­é›†æˆä»»åŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA"><span class="toc-text">æ„å»º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2"><span class="toc-text">éƒ¨ç½²</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E8%87%AA%E5%8A%A8%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90"><span class="toc-text">é…ç½®è‡ªåŠ¨æŒç»­é›†æˆ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jenkins-gh-pages-%E5%AE%9E%E7%8E%B0%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90"><span class="toc-text">jenkins + gh-pages å®ç°æŒç»­é›†æˆ</span></a></li></ol>
    </div>
  </div>


            </div>
        
        
          <blockquote id="copyright">
              <p>åŸæ–‡é“¾æ¥: <a href="http://blog.jajabjbj.top/2020/02/19/2020-02-19/">http://blog.jajabjbj.top/2020/02/19/2020-02-19/</a></p>
              <p>ç‰ˆæƒå£°æ˜: è½¬è½½è¯·æ³¨æ˜å‡ºå¤„.</p>
          </blockquote>
        
      
    </div>
    <footer class="article-footer">
      
        <div class="article-tag-wrap">
          

          
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/" rel="tag">jenkins</a></li></ul>

          
    <div class="social-share">
      <span>åˆ†äº«åˆ°:</span>
    </div>



        </div>
      
      
        
<nav id="article-nav">
  
    <a href="/2018/08/29/cache/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">older</strong>
      <div class="article-nav-title">
        
          ä½¿ç”¨é«˜é˜¶ç»„ä»¶å®ç°é¡µé¢çš„è¡¨å•æ•°æ®å’Œstateç¼“å­˜
        
      </div>
    </a>
  
  
    <a href="/2022/07/10/wasm/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">newer</strong>
      <div class="article-nav-title">
        
          ä»€ä¹ˆæ˜¯ wasm(webassembly) æŠ€æœ¯
        
      </div>
    </a>
  
</nav>

      
      
        








      
    </footer>
  </div>
</article>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-posts"></i> æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/07/10/wasm/">ä»€ä¹ˆæ˜¯ wasm(webassembly) æŠ€æœ¯</a>
          </li>
        
          <li>
            <a href="/2020/02/19/2020-02-19/">å‰ç«¯æŒç»­é›†æˆç¯å¢ƒæ­å»º</a>
          </li>
        
          <li>
            <a href="/2018/08/29/cache/">ä½¿ç”¨é«˜é˜¶ç»„ä»¶å®ç°é¡µé¢çš„è¡¨å•æ•°æ®å’Œstateç¼“å­˜</a>
          </li>
        
          <li>
            <a href="/2018/05/30/2018-05-30/">ä½¿ç”¨ openssl ç”Ÿæˆè¯ä¹¦</a>
          </li>
        
          <li>
            <a href="/2018/05/30/2018-05-31-1/">æ­å»º gitlab-ci æŒç»­é›†æˆç¯å¢ƒ</a>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-tag"></i> æ ‡ç­¾äº‘</h3>
    <div class="widget tagcloud">
      <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/gitab-ci/" style="font-size: 10px;">gitab-ci</a> <a href="/tags/gitlab-ci/" style="font-size: 10px;">gitlab-ci</a> <a href="/tags/javascript/" style="font-size: 10px;">javascript</a> <a href="/tags/jenkins/" style="font-size: 10px;">jenkins</a> <a href="/tags/k8s/" style="font-size: 10px;">k8s</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/wasm-webassembly-nodejs/" style="font-size: 10px;">wasm webassembly nodejs</a> <a href="/tags/webpack/" style="font-size: 20px;">webpack</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-link"></i> å‹æƒ…é“¾æ¥</h3>
    <div class="widget">
      <ul>
      
        <li>
          <a target="_blank" rel="noopener" href="https://juejin.cn/user/3667626519435870/posts">æˆ‘çš„æ˜é‡‘</a>
        </li>
      
        <li>
          <a target="_blank" rel="noopener" href="https://juejin.cn/user/8451822983784/posts">æˆ‘çš„æ˜é‡‘2</a>
        </li>
      
      </ul>
    </div>
  </div>


  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title"><i class="fa fa-archive"></i> å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022å¹´</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020å¹´</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018å¹´</a><span class="archive-list-count">12</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <a id="totop" href="#top"></a>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <p>
        <a href="/sitemap.xml">ç½‘ç«™åœ°å›¾</a>
        <span> | </span><a href="/atom.xml">è®¢é˜…æœ¬ç«™</a>
        <span> | </span><a href="/about/">è”ç³»åšä¸»</a>
      </p>
      
      <p>
        <span>Copyright &copy; 2022 Wayne.</span>
        <span>Theme by <a href="https://github.com/chaooo/hexo-theme-BlueLake/" target="_blank">BlueLake.</a></span>
        <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo.</a></span>
        <div style="background: #ffffffbd; border-radius: 12px;  width: 240px; margin: 0 auto; display: flex; justify-content: center; align-items: center;" class="content___2IB17">
          <div style="display: flex; justify-content: center; align-items: center; margin-left: 12px;">
            <img style="width: 20px; height: 20px; margin-right: 4px;" src="data:image/gif;base64,R0lGODlhMgAyALMOAP6/Av6mAv4eAv54Av5OAv7tnv7gbP7YOv7+Av5kAv4xAv6XAv7OA/4DAv///wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QUM4RkQzMENFMzI4MTFFMDlCODBFRDg1OUUzMzg3RkMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QUM4RkQzMERFMzI4MTFFMDlCODBFRDg1OUUzMzg3RkMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBQzhGRDMwQUUzMjgxMUUwOUI4MEVEODU5RTMzODdGQyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBQzhGRDMwQkUzMjgxMUUwOUI4MEVEODU5RTMzODdGQyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAA4ALAAAAAAyADIAAAT/0MlJq7046827/2AoOgbDHMWoTsVhvgBjrGBhADGzEETA5CiapoT7JQSNZEMwiBVnQoqruFNalYTF6xSVmAAD5HWcFCR8jJSwACa7rwnAIWoSXwWKvOJtEpYCd3FbJgEEYwNcKjcAe0pnRw1aDANLAwGNZSZzIjcMhkoLlFgmmAILCVYEmiE/l1YDokoKJmNVsmgMH7SvgGO7VgIAn0o/ah2/DbN2SgLIjghXfboMwJipP9Z8adNiCgl64AqSC+HgdtIeJY2WC+3u7/DwbcnoHTfZZHh5b7L1HGyo+DVA04ufqlwgdCQBEM/dloYLAixI0gSKrl4DEmjU6OPURo4M3AJ8/JZkAQBjHpwlmcVgWZIEP9z4s8cgIK5BOHH2YjlCYQOSA2uWy6NFVIJPMDexapkkgIBmNUduzIGnoA8VBwAEPIPIFRmYOgB0m3lRCaJJAcIAG9DuxzAtFkWYGEZA2M94huKUIvuhQEhgAUTeqbtgmcm4PWte6aE4EhiXPOkwwCew6bYoRCof4pu4oGawXSiYiCXwIMoubCZVPqg0tIQSPt3AlOPaAmynZM62rj0BRsAyaADwxuDCROEGZ02cHj6heE7mGvzm+IEY+oUpl61vWK69u/fv4MM7iAAAOw==" alt="" />
            <a style="margin-left: 10px; color: #666979;" href="https://beian.miit.gov.cn" target="_blank" rel="noreferrer">æ¹˜ICPå¤‡16020172å·-1</a>
          </div>
          <!-- <div style="display: flex; justify-content: center; align-items: center; margin-left: 12px;">
            <img style="width: 20px; height: 20px; margin-right: 4px;" src="https://portal.open.hand-china.com/static/beian-icon.0c577066.png" alt="">
            <a style="margin-left: 10px; color: #666979;" href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011802002577" target="_blank" rel="noreferrer">æ¹˜å…¬ç½‘å®‰å¤‡ 31011802002577å·</a>
          </div> -->
        </div>
      </p>
    </div>
  </div>
</footer>

    </div>
  </div>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/search.json.js"></script>




<script src="/js/script.js"></script>








  
    
<script src="/localshare/js/social-share.js"></script>

    
<script src="/localshare/js/qrcode.js"></script>

  
  



  

  

  

  

  

  

  

  
  





<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>